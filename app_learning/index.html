<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sentence Builder – Present/Past/Future Simple</title>
    <link href="style.css" rel="stylesheet">
</head>

<body>
    <header>
        <h1>Sentence Builder (Simple Tenses)</h1>
        <p>• Present / Past / Future Simple • typ: Affirmative / Negative / Question</p>
    </header>

    <div class="wrap">
        <div class="panel">
            <div class="grid">
                <div class="col-3">
                    <label for="subject">Subject (podmiot)</label>
                    <select id="subject">
                        <option>I</option>
                        <option>you</option>
                        <option>he</option>
                        <option>she</option>
                        <option>it</option>
                        <option>we</option>
                        <option>they</option>
                    </select>
                </div>
                <div class="col-3">
                    <label for="tense">Tense (czas)</label>
                    <select id="tense">
                        <option>Present Simple</option>
                        <option>Past Simple</option>
                        <option>Future Simple</option>
                    </select>
                </div>
                <div class="col-3">
                    <label for="stype">Sentence type</label>
                    <select id="stype">
                        <option>Affirmative</option>
                        <option>Negative</option>
                        <option>Question</option>
                    </select>
                </div>
                <div class="col-3">
                    <label for="adj">Adjective (opcjonalnie)</label>
                    <select id="adj">
                        <option value=""></option>
                        <option value="big">big</option>
                        <option value="small">small</option>
                        <option value="good">good</option>
                        <option value="bad">bad</option>
                        <option value="new">new</option>
                    </select>
                </div>
                <div class="col-6">
                    <label for="noun">Noun (rzeczownik)</label>
                    <select id="noun"></select>
                </div>
                <div class="col-3">
                    <label for="num">Number</label>
                    <select id="num">
                        <option value="sg">singular</option>
                        <option value="pl">plural</option>
                    </select>
                </div>
                <div class="col-3">
                    <label for="verb">Verb (czasownik)</label>
                    <select id="verb"></select>
                </div>
            </div>

            <div class="controls">
                <button class="primary" id="genBtn">GENERUJ ZDANIE</button>
                <button id="rndBtn">Losuj</button>
            </div>

            <div class="result" id="outEn">Zdanie po angielsku pojawi się tutaj.</div>
            <div class="result" id="outPl">Tłumaczenie po polsku pojawi się tutaj.</div>
        </div>
    </div>

    <script>
        let nouns = [], verbs = [];

        async function loadData() {
            nouns = await fetch('nouns.json').then(res => res.json());
            verbs = await fetch('verbs.json').then(res => res.json());
            // Sortowanie rzeczowników po angielskiej formie liczby pojedynczej
            nouns.sort((a, b) => {
                if (a.en.sg.toLowerCase() < b.en.sg.toLowerCase()) return -1;
                if (a.en.sg.toLowerCase() > b.en.sg.toLowerCase()) return 1;
                return 0;
            });

            // Sortowanie czasowników po angielskiej formie podstawowej
            verbs.sort((a, b) => {
                if (a.en.base.toLowerCase() < b.en.base.toLowerCase()) return -1;
                if (a.en.base.toLowerCase() > b.en.base.toLowerCase()) return 1;
                return 0;
            });
            populateSelects();
            generate();
        }

        function populateSelects() {
            const nSel = $('#noun');
            nouns.forEach((n, i) => {
                const o = document.createElement('option');
                o.value = i;
                o.textContent = `${n.en.sg} / ${n.en.pl}`;
                nSel.appendChild(o);
            });

            const vSel = $('#verb');
            verbs.forEach((v, i) => {
                const o = document.createElement('option');
                o.value = i;
                o.textContent = `${v.en.base} / ${v.en.third} / ${v.en.past}`;
                vSel.appendChild(o);
            });
        }

        loadData();

        const adjs = {
            '': { en: '', pl: '' },
            big: { en: 'big', pl: 'duży' },
            small: { en: 'small', pl: 'mały' },
            good: { en: 'good', pl: 'dobry' },
            bad: { en: 'bad', pl: 'zły' },
            new: { en: 'new', pl: 'nowy' }
        };

        const pronPL = { I: 'Ja', you: 'Ty', he: 'On', she: 'Ona', it: 'To', we: 'My', they: 'Oni' };

        const $ = s => document.querySelector(s);
        function is3p(subject) { return ['he', 'she', 'it'].includes(subject) }
        function articleFor(word) { return /^[aeiou]/.test(word) ? 'an' : 'a' }

        (function init() {
            const nSel = $('#noun');
            nouns.forEach((n, i) => { const o = document.createElement('option'); o.value = i; o.textContent = `${n.en.sg} / ${n.en.pl}`; nSel.appendChild(o); });
            const vSel = $('#verb');
            verbs.forEach((v, i) => { const o = document.createElement('option'); o.value = i; o.textContent = `${v.en.base} / ${v.en.third} / ${v.en.past}`; vSel.appendChild(o); });
        })();

        function buildEnglish() {
            const subject = $('#subject').value; const tense = $('#tense').value; const stype = $('#stype').value;
            const noun = nouns[+$('#noun').value]; const num = $('#num').value;
            const adjKey = $('#adj').value; const adj = adjs[adjKey];
            const verb = verbs[+$('#verb').value];

            const nEn = num === 'sg' ? noun.en.sg : noun.en.pl;
            const nPhrase = (adj.en ? `${adj.en} ${nEn}` : nEn);

            let objPhrase = nPhrase;
            if (num === 'sg' && stype !== 'Question') { // add article for simple object in statements/negations
                if (!['water', 'music'].includes(nEn)) objPhrase = `${articleFor(nPhrase)} ${nPhrase}`;
            }

            let en = '';
            if (stype === 'Affirmative') {
                if (tense === 'Present Simple') en = `${subject} ${is3p(subject) ? verb.en.third : verb.en.base} ${objPhrase}.`;
                if (tense === 'Past Simple') en = `${subject} ${verb.en.past} ${nPhrase}.`;
                if (tense === 'Future Simple') en = `${subject} will ${verb.en.base} ${nPhrase}.`;
            } else if (stype === 'Negative') {
                if (tense === 'Present Simple') en = `${subject} ${is3p(subject) ? 'does' : 'do'} not ${verb.en.base} ${nPhrase}.`;
                if (tense === 'Past Simple') en = `${subject} did not ${verb.en.base} ${nPhrase}.`;
                if (tense === 'Future Simple') en = `${subject} will not ${verb.en.base} ${nPhrase}.`;
            } else if (stype === 'Question') {
                if (tense === 'Present Simple') en = `${is3p(subject) ? 'Does' : 'Do'} ${subject} ${verb.en.base} ${nPhrase}?`;
                if (tense === 'Past Simple') en = `Did ${subject} ${verb.en.base} ${nPhrase}?`;
                if (tense === 'Future Simple') en = `Will ${subject} ${verb.en.base} ${nPhrase}?`;
            }
            return en.replace(/^([a-z])/, m => m.toUpperCase());
        }

        function buildPolish() {
            const subject = $('#subject').value; const tense = $('#tense').value; const stype = $('#stype').value;
            const noun = nouns[+$('#noun').value]; const num = $('#num').value;
            const adjKey = $('#adj').value; const adj = adjs[adjKey];
            const verb = verbs[+$('#verb').value];

            const sPL = pronPL[subject];
            const nPL = num === 'sg' ? noun.pl.sg : noun.pl.pl;
            const nPhrasePL = (adj.pl ? `${adj.pl} ${nPL}` : nPL); // uproszczone – bez odmiany przymiotnika

            let vPL = '';
            if (tense === 'Present Simple') vPL = verb.pl.pres[subject];
            if (tense === 'Past Simple') vPL = verb.pl.past[subject];
            if (tense === 'Future Simple') vPL = verb.pl.fut[subject];

            let pl = '';
            if (stype === 'Affirmative') {
                pl = `${sPL} ${vPL} ${nPhrasePL}.`;
            } else if (stype === 'Negative') {
                pl = `${sPL} nie ${vPL} ${nPhrasePL}.`;
            } else if (stype === 'Question') {
                pl = `Czy ${sPL.toLowerCase()} ${vPL} ${nPhrasePL}?`;
            }
            return pl.replace(/^([A-Za-zĄąĆćĘęŁłŃńÓóŚśŹźŻż])/, m => m.toUpperCase());
        }

        function generate() {
            $('#outEn').textContent = buildEnglish();
            $('#outPl').textContent = buildPolish();
        }

        function randomize() {
            $('#subject').selectedIndex = Math.floor(Math.random() * 7);
            $('#tense').selectedIndex = Math.floor(Math.random() * 3);
            $('#stype').selectedIndex = Math.floor(Math.random() * 3);
            $('#adj').selectedIndex = Math.floor(Math.random() * 6);
            $('#noun').selectedIndex = Math.floor(Math.random() * nouns.length);
            $('#num').selectedIndex = Math.floor(Math.random() * 2);
            $('#verb').selectedIndex = Math.floor(Math.random() * verbs.length);
            generate();
        }

        $('#genBtn').addEventListener('click', generate);
        $('#rndBtn').addEventListener('click', randomize);
        generate();
    </script>
</body>

</html>
